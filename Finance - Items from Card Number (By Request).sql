select t.no as "Trx No", o."orderNumber", t."cardNo", m.company , c."productType", t."createdAt" + '07:00' as Date, t.type, t.amount
  , o.items->0->'name' as item1, o.items->0->'variants'->0->'quantity' as quantity1, o.items->0->'variants'->0->'price' as price1
 , o.items->1->'name' as item2, o.items->1->'variants'->0->'quantity' as quantity2, o.items->1->'variants'->0->'price' as price2
 , o.items->0->'name' as item4, o.items->0->'variants'->1->'quantity' as quantity4, o.items->0->'variants'->1->'price' as price4
 , o.items->2->'name' as item3, o.items->2->'variants'->0->'quantity' as quantity3, o.items->2->'variants'->0->'price' as price3
 , d.brand
  from "Transactions" as t

  inner join "CardInventories" as i
    on t."distributionId" = i."distributionId"
  inner join "CardPrograms" as c
    on c."programId" = i."programId"
  left join "Distributors" as d
    on d.id = t."DistributorId"
  inner join "Merchants" as m
    on t."MerchantId" = m.id
  LEFT join "Orders" as o
    on o."TransactionId" = t.id

where t.status = 'accepted'
  and t."createdAt" >= '20170801'
  and t."createdAt" <= '20170831'
  and t.type  = 'redemption'
  and t."cardNo" in
  ('2861365057923022','2861154954862198','2861673797575568','2861025897819703','2861025897819703','2861025897819703','2861025897819703','2861949693903041','2861414615205587','2861436869181214','2861931284630761','2861517816953639','2861745487672150','2861025897819703','2861276692064223','2861276692064223','2861809664722822','2861087460482111','2861357167087376','2861357167087376','2861834143530034','2861316409751918','2861362682749682','2861070887090451','2861126424793260','2861070887090451','2861113892152591','2861775974803976','2861179881247429','2861414615205587','2861953511914891','2861477992768477','2861152020373182','2861152020373182','2861572289088645','2861538330519805','2861097846677227','2861591998857132','2861114007363982','2861229092417962','2861702012182544','2861154954862198','2861504987308199','2861504987308199','2861152020373182','2861572289088645','2861036635693524','2861097846677227','2861281996762894','2861811462752811','2861418251892947','2861847846828034','2861154954862198','2861652204135869','2861504987308199','2861113892152591','2861729461084384','2861315364687265','2861179881247429','2861114007363982','2861281996762894','2861702012182544','2861775974803976','2861652204135869','2861097255872947','2861201703925048','2861677774140833','2861593717853111','2861316409751918','2861593243666276','2861114007363982','2861259036642540','2861702012182544','2861108404377090','2861840209963951','2861494452588956','2861415276300328','2861443599272420','2861036635693524','2861315364687265','2861593243666276','2861215715595748','2861811462752811','2861903521423516','2861207020633934','2861025897819703','2861504987308199','2861477931383099')

  order by t."createdAt" asc